---
title: "Built-in Variables"
icon: "code-simple"
---

This document describes all template variables and utility functions available in Osmedeus workflows.

## Template Syntax

- **Standard variables:** `{{VariableName}}` - Available throughout workflows
- **Foreach loop variables:** `[[variable]]` - Only within foreach step inner steps

## Built-in Template Variables

### Settings Variables

From configuration (`osm-settings.yaml`):

| Variable | Description |
|----------|-------------|
| `{{BaseFolder}}` | Base installation folder |
| `{{Binaries}}` | Binaries directory path |
| `{{Data}}` | Data directory path (wordlists, etc.) |
| `{{ExternalConfigs}}` | External configurations path |
| `{{ExternalAgentConfigs}}` | External agent configs path |
| `{{ExternalScripts}}` | External scripts directory |
| `{{Workflows}}` | Workflows directory path |
| `{{MarkdownTemplates}}` | Markdown report templates path |
| `{{SnapshotsFolder}}` | Snapshots directory path |
| `{{Workspaces}}` | Workspaces directory (override with -W flag) |

### Thread Settings

| Variable | Description |
|----------|-------------|
| `{{threads}}` | Number of threads (configurable per tactic, override with --threads-hold) |
| `{{baseThreads}}` | Base thread count (typically half of threads) |

### Target Variables

| Variable | Description |
|----------|-------------|
| `{{Target}}` | Target being scanned (from -t parameter) |
| `{{TargetFile}}` | Target file path (from CLI parameter) |
| `{{TargetSpace}}` | Filesystem-safe target identifier (override with -S flag) |
| `{{Workspace}}` | Workspace name (same as TargetSpace) |

### Execution Variables

| Variable | Description |
|----------|-------------|
| `{{workflow}}` | Workflow name |
| `{{run_id}}` | 8-character unique run identifier |
| `{{Output}}` | Output directory path for results |
| `{{WorkspaceName}}` | Database workspace identifier |

### Time Variables

| Variable | Description |
|----------|-------------|
| `{{TaskDate}}` | Current date (`2006-01-02` format) |
| `{{TaskID}}` | Same as run_id |
| `{{TimeStamp}}` | Unix timestamp (seconds since epoch) |
| `{{CurrentTime}}` | Current time ISO format (`2006-01-02T15:04:05`) |
| `{{Today}}` | Current date (`2006-01-02` format) |
| `{{RandomString}}` | 8-character random alphanumeric string |

### State Path Variables

| Variable | Description |
|----------|-------------|
| `{{StateExecutionLog}}` | Execution log (`{{Output}}/run-execution.log`) |
| `{{StateCompletedFile}}` | Completion marker (`{{Output}}/run-completed.json`) |
| `{{StateFile}}` | Run state file (`{{Output}}/run-state.json`) |
| `{{StateWorkflowFile}}` | Exported workflow (`{{Output}}/run-workflow.yaml`) |
| `{{StateWorkflowFolder}}` | Module storage (`{{Output}}/run-modules`) |

### Constants

| Variable | Description |
|----------|-------------|
| `{{DefaultUA}}` | Default User-Agent string |
| `{{Version}}` | Osmedeus version |

## Heuristics Variables

When `heuristics_check` is not `"none"`, additional variables are auto-detected.


**Example Target:** `https://api.shop.example.com:8443/v2/products/search?q=test#results`

| Variable | Description | Example Value |
|----------|-------------|---------------|
| `{{TargetType}}` | Target type identifier | `"url"` |
| `{{TargetBaseURL}}` | Base URL (scheme + host + port) | `https://api.shop.example.com:8443` |
| `{{TargetRootURL}}` | Root URL (scheme + host + port) | `https://api.shop.example.com:8443` |
| `{{TargetHostname}}` | Full hostname | `api.shop.example.com` |
| `{{TargetRootDomain}}` | Root domain extracted from hostname | `example.com` |
| `{{TargetHost}}` | Host (hostname + port) | `api.shop.example.com:8443` |
| `{{TargetPort}}` | Port number | `8443` |
| `{{TargetPath}}` | URL path component | `/v2/products/search` |
| `{{TargetFileExt}}` | File extension if present | `` (empty) |
| `{{TargetScheme}}` | HTTP scheme | `https` |
| `{{TargetStatusCode}}` | HTTP status code (if reachable) | `200` |
| `{{TargetContentLength}}` | Content length of response | `4521` |
| `{{TargetTLD}}` | Top-level domain | `com` |

### Additional URL Examples

**Example with file path:** `https://cdn.example.org/assets/images/logo.png`

| Variable | Example Value |
|----------|---------------|
| `{{TargetBaseURL}}` | `https://cdn.example.org` |
| `{{TargetHostname}}` | `cdn.example.org` |
| `{{TargetRootDomain}}` | `example.org` |
| `{{TargetHost}}` | `cdn.example.org` |
| `{{TargetPort}}` | `443` |
| `{{TargetPath}}` | `/assets/images/logo.png` |
| `{{TargetFileExt}}` | `png` |
| `{{TargetScheme}}` | `https` |
| `{{TargetTLD}}` | `org` |

**Example with HTTP and explicit port:** `http://staging.app.example.io:3000/api/health`

| Variable | Example Value |
|----------|---------------|
| `{{TargetBaseURL}}` | `http://staging.app.example.io:3000` |
| `{{TargetHostname}}` | `staging.app.example.io` |
| `{{TargetRootDomain}}` | `example.io` |
| `{{TargetHost}}` | `staging.app.example.io:3000` |
| `{{TargetPort}}` | `3000` |
| `{{TargetPath}}` | `/api/health` |
| `{{TargetFileExt}}` | `` (empty) |
| `{{TargetScheme}}` | `http` |
| `{{TargetTLD}}` | `io` |

---

## Domain Target Variables

**Example Target:** `mail.corp.example.com`

| Variable | Description | Example Value |
|----------|-------------|---------------|
| `{{TargetType}}` | Target type identifier | `"domain"` |
| `{{TargetRootDomain}}` | Root domain | `example.com` |
| `{{TargetIsWildcard}}` | Boolean indicating wildcard domain | `false` |
| `{{TargetResolvedIP}}` | Resolved IP address (if DNS succeeds) | `93.184.216.34` |
| `{{TargetTLD}}` | Top-level domain | `com` |

### Additional Domain Examples

**Example wildcard domain:** `*.example.net`

| Variable | Example Value |
|----------|---------------|
| `{{TargetType}}` | `"domain"` |
| `{{TargetRootDomain}}` | `example.net` |
| `{{TargetIsWildcard}}` | `true` |
| `{{TargetResolvedIP}}` | `` (empty - wildcard cannot be resolved) |
| `{{TargetTLD}}` | `net` |

**Example subdomain:** `dev.api.example.co.uk`

| Variable | Example Value |
|----------|---------------|
| `{{TargetType}}` | `"domain"` |
| `{{TargetRootDomain}}` | `example.co.uk` |
| `{{TargetIsWildcard}}` | `false` |
| `{{TargetResolvedIP}}` | `185.199.108.153` |
| `{{TargetTLD}}` | `co.uk` |

---

## Usage in Workflows

```yaml
steps:
  - name: probe-url
    type: bash
    cmd: |
      echo "Scanning {{TargetHostname}} on port {{TargetPort}}"
      curl -s -o /dev/null -w "%{http_code}" {{TargetBaseURL}}{{TargetPath}}

  - name: enumerate-domain
    type: bash
    cmd: |
      echo "Root domain: {{TargetRootDomain}}"
      echo "Resolved IP: {{TargetResolvedIP}}"
      subfinder -d {{TargetRootDomain}} -o {{Output}}/subdomains.txt
```

## Foreach Loop Variables

Within foreach step inner steps, use double bracket syntax:

| Variable | Description |
|----------|-------------|
| `[[item]]` or `[[<variable>]]` | Current loop item value |
| `[[_id_]]` | 1-based iteration counter |

**Example:**
```yaml
- name: process-items
  type: foreach
  input: "{{Output}}/targets.txt"
  variable: target
  threads: 5
  step:
    type: bash
    command: echo "Processing [[target]] (iteration [[_id_]])"
```

## Parameter Generators

Auto-generate values for workflow parameters:

| Generator | Description |
|-----------|-------------|
| `uuid()` | Generate UUID v4 |
| `currentDate(format?)` | Current date (default: `2006-01-02`) |
| `currentTimestamp()` | Unix timestamp |
| `getEnvVar(key, default?)` | Environment variable |
| `concat(str1, str2, ...)` | Concatenate strings |
| `randomInt(min?, max?)` | Random integer (default: 0-100) |
| `randomString(length?)` | Random alphanumeric (default: 16 chars) |
| `execCmd(command)` | Execute shell command |
| `toLower(str)` | Convert to lowercase |
| `toUpper(str)` | Convert to uppercase |
| `trim(str)` | Trim whitespace |
| `replace(str, old, new)` | Replace occurrences |
| `split(str, delim, index?)` | Split and return element |
| `join(delim, str1, str2, ...)` | Join with delimiter |

**Example:**
```yaml
params:
  - name: run_id
    generator: uuid()
  - name: start_date
    generator: currentDate()
  - name: api_key
    generator: getEnvVar("API_KEY", "default-key")
```

## Utility Functions

Functions available in `pre_condition`, `decision`, `exports`, and function steps.

### File Functions

| Function | Return | Description |
|----------|--------|-------------|
| `fileExists(path)` | bool | Check if file exists |
| `fileLength(path)` | int | Count non-empty lines |
| `dirLength(path)` | int | Count directory entries |
| `fileContains(path, pattern)` | bool | Check if file contains pattern |
| `regexExtract(path, pattern)` | []string | Extract regex matches from file |
| `readFile(path)` | string | Read file contents |
| `readLines(path)` | []string | Read file as line array |
| `removeFile(path)` | bool | Remove file |
| `removeFolder(path)` | bool | Remove folder |
| `rm_rf(path)` | bool | Remove recursively |
| `remove_all_except(folder, keep)` | bool | Remove all except one file |
| `createFolder(path)` | bool | Create directory |
| `appendFile(dest, source)` | bool | Append source to dest |
| `glob(pattern)` | []string | Find files matching glob |
| `grep_string_to_file(dest, src, str)` | bool | Grep string to file |
| `grep_regex_to_file(dest, src, pat)` | bool | Grep regex to file |
| `grep_string(source, str)` | string | Grep string from file |
| `grep_regex(source, pattern)` | string | Grep regex from file |

### String Functions

| Function | Return | Description |
|----------|--------|-------------|
| `trim(str)` | string | Trim whitespace |
| `split(str, delim)` | []string | Split string |
| `join(arr, delim)` | string | Join array |
| `replace(str, old, new)` | string | Replace all occurrences |
| `contains(str, substr)` | bool | Check substring |
| `startsWith(str, prefix)` | bool | Check prefix |
| `endsWith(str, suffix)` | bool | Check suffix |
| `toLowerCase(str)` | string | Convert to lowercase |
| `toUpperCase(str)` | string | Convert to uppercase |
| `match(str, pattern)` | bool | Regex match |
| `regex_match(pattern, str)` | bool | Regex match (alt) |
| `cut_with_delim(input, delim, field)` | string | Extract field (1-indexed) |
| `normalize_path(input)` | string | Normalize path |
| `clean_sub(path, target?)` | bool | Clean subdomain file |

### Type Conversion

| Function | Return | Description |
|----------|--------|-------------|
| `parseInt(str)` | int | Parse integer |
| `parseFloat(str)` | float | Parse float |
| `toString(val)` | string | Convert to string |
| `toBoolean(val)` | bool | Convert to boolean |

### Utility

| Function | Return | Description |
|----------|--------|-------------|
| `len(val)` | int | Get length |
| `isEmpty(val)` | bool | Check if empty |
| `isNotEmpty(val)` | bool | Check if not empty |
| `printf(message)` | void | Print message |
| `cat_file(path)` | void | Print file contents |
| `exit(code)` | void | Exit with code |
| `exec_cmd(command)` | string | Execute command |
| `sleep(seconds)` | void | Sleep |

### Logging

| Function | Return | Description |
|----------|--------|-------------|
| `log_debug(message)` | void | Debug log |
| `log_info(message)` | void | Info log |
| `log_warn(message)` | void | Warning log |
| `log_error(message)` | void | Error log |

### HTTP

| Function | Return | Description |
|----------|--------|-------------|
| `httpRequest(url, method, headers, body)` | object | HTTP request |
| `http_get(url)` | object | GET request |
| `http_post(url, body)` | object | POST request |

### Generation

| Function | Return | Description |
|----------|--------|-------------|
| `randomString(length)` | string | Random alphanumeric |
| `uuid()` | string | Generate UUID |

### Encoding

| Function | Return | Description |
|----------|--------|-------------|
| `base64Encode(str)` | string | Base64 encode |
| `base64Decode(str)` | string | Base64 decode |

### Data Query

| Function | Return | Description |
|----------|--------|-------------|
| `jq(jsonData, query)` | any | JQ query on JSON |
| `jq_from_file(path, query)` | any | JQ query on file |

### Notification

| Function | Return | Description |
|----------|--------|-------------|
| `notifyTelegram(message)` | bool | Send Telegram message |
| `sendTelegramFile(path, caption?)` | bool | Send file via Telegram |
| `notifyWebhook(message)` | bool | Send webhook |
| `sendWebhookEvent(type, data)` | bool | Send webhook event |

### CDN/Storage

| Function | Return | Description |
|----------|--------|-------------|
| `cdnUpload(local, remote)` | bool | Upload to CDN |
| `cdnDownload(remote, local)` | bool | Download from CDN |
| `cdnExists(remote)` | bool | Check CDN file exists |
| `cdnDelete(remote)` | bool | Delete from CDN |

### Unix Commands

| Function | Return | Description |
|----------|--------|-------------|
| `sortUnix(input, output?)` | bool | Sort file |
| `wgetUnix(url, output?)` | bool | Download URL |
| `gitClone(repo, dest?)` | bool | Clone repository |
| `zipUnix(source, dest)` | bool | Create zip |
| `unzipUnix(source, dest?)` | bool | Extract zip |
| `tarUnix(source, dest)` | bool | Create tar |
| `untarUnix(source, dest?)` | bool | Extract tar |
| `diffUnix(file1, file2, output?)` | string | Diff files |

### Archive

| Function | Return | Description |
|----------|--------|-------------|
| `zip_dir(source, dest)` | bool | Zip directory |
| `unzip_dir(source, dest)` | bool | Unzip directory |

### Output

| Function | Return | Description |
|----------|--------|-------------|
| `save_content(content, path)` | bool | Save content to file |
| `jsonl_to_csv(source, dest)` | bool | Convert JSONL to CSV |
| `csv_to_jsonl(source, dest)` | bool | Convert CSV to JSONL |
| `jsonl_unique(source, dest, fields)` | bool | Deduplicate JSONL |
| `jsonl_filter(source, dest, fields)` | bool | Filter JSONL fields |

### Markdown

| Function | Return | Description |
|----------|--------|-------------|
| `render_markdown_from_file(path)` | string | Render markdown |
| `print_markdown_from_file(path)` | void | Print markdown |
| `convert_jsonl_to_markdown(path)` | string | JSONL to markdown |
| `convert_csv_to_markdown(path)` | string | CSV to markdown |
| `render_markdown_report(tpl, out)` | bool | Render report |
| `generate_security_report(tpl)` | bool | Generate security report |

### Database

| Function | Return | Description |
|----------|--------|-------------|
| `db_update(table, key, field, val)` | bool | Update record |
| `db_import_asset(workspace, json)` | bool | Import asset |
| `db_raw_insert_asset(workspace, json)` | int | Insert asset (return ID) |
| `db_total_urls(file)` | int | Count URLs |
| `db_total_subdomains(file)` | int | Count subdomains |
| `db_total_assets(file)` | int | Count assets |
| `db_total_vulns(file)` | int | Count vulnerabilities |
| `db_vuln_critical(file)` | int | Count critical vulns |
| `db_vuln_high(file)` | int | Count high vulns |
| `db_vuln_medium(file)` | int | Count medium vulns |
| `db_vuln_low(file)` | int | Count low vulns |
| `runtime_export()` | bool | Export runtime state |
| `register_artifact(path, type?)` | bool | Register artifact |
| `store_artifact(path)` | bool | Store artifact |
| `db_select_assets(workspace, fmt)` | string | Select assets |
| `db_select_assets_filtered(...)` | string | Select assets filtered |
| `db_select_vulnerabilities(ws, fmt)` | string | Select vulnerabilities |
| `db_select_vulnerabilities_filtered(...)` | string | Select vulns filtered |
| `db_select(sql, format)` | string | Raw SQL query |
| `db_select_total_subdomains()` | int | Total subdomains |
| `db_select_total_urls()` | int | Total URLs |
| `db_select_total_assets()` | int | Total assets |
| `db_select_total_vulns()` | int | Total vulnerabilities |
| `db_select_vuln_critical()` | int | Critical vulns count |
| `db_select_vuln_high()` | int | High vulns count |
| `db_select_vuln_medium()` | int | Medium vulns count |
| `db_select_vuln_low()` | int | Low vulns count |

## Usage Examples

### Pre-condition

```yaml
- name: conditional-step
  type: bash
  pre_condition: 'fileExists("{{Output}}/targets.txt") && fileLength("{{Output}}/targets.txt") > 0'
  command: cat {{Output}}/targets.txt
```

### Exports

```yaml
- name: count-results
  type: function
  function: 'toString(fileLength("{{Output}}/results.txt"))'
  exports:
    result_count: "{{_result_}}"
```

### Decision

```yaml
- name: check-results
  type: bash
  command: echo "Checking"
  decision:
    switch: '{{result_count}}'
    cases:
      "0": { goto: no-results }
    default: { goto: process-results }
```

### Function Step

```yaml
- name: notify-completion
  type: function
  functions:
    - log_info("Scan completed for {{Target}}")
    - notifyTelegram("Scan done: {{Target}}")
    - runtime_export()
```
